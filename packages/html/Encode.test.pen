import Test'Assert

import 'Encode { Encode }
import 'Node { Node, Attribute, Element }

EncodeElement = \() none | error {
  Assert'True(
    Encode(
      Element{
        Tag: Node'Html{},
        Attributes: [Attribute],
        Children: [Node],
      },
    )?
      == "<html/>",
  )
}

EncodeAttribute = \() none | error {
  Assert'True(
    Encode(
      Element{
        Tag: Node'Html{},
        Attributes: [Attribute Attribute{Key: "foo", Value: "bar"}],
        Children: [Node],
      },
    )?
      == "<html foo=\"bar\"/>",
  )
}

EncodeAttributes = \() none | error {
  Assert'True(
    Encode(
      Element{
        Tag: Node'Html{},
        Attributes: [Attribute
          Attribute{Key: "foo", Value: "bar"},
          Attribute{Key: "baz", Value: "blah"},
        ],
        Children: [Node],
      },
    )?
      == "<html foo=\"bar\"baz=\"blah\"/>",
  )
}

EncodeAttributeWithChild = \() none | error {
  Assert'True(
    Encode(
      Element{
        Tag: Node'Html{},
        Attributes: [Attribute Attribute{Key: "foo", Value: "bar"}],
        Children: [Node
          Element{
            Tag: Node'Body{},
            Attributes: [Attribute],
            Children: [Node],
          },
        ],
      },
    )?
      == "<html foo=\"bar\"><body/></html>",
  )
}

EncodeChild = \() none | error {
  Assert'True(
    Encode(
      Element{
        Tag: Node'Html{},
        Attributes: [Attribute],
        Children: [Node
          Element{
            Tag: Node'Body{},
            Attributes: [Attribute],
            Children: [Node],
          },
        ],
      },
    )?
      == "<html><body/></html>",
  )
}

EncodeChildren = \() none | error {
  Assert'True(
    Encode(
      Element{
        Tag: Node'Html{},
        Attributes: [Attribute],
        Children: [Node
          Element{
            Tag: Node'Head{},
            Attributes: [Attribute],
            Children: [Node],
          },
          Element{
            Tag: Node'Body{},
            Attributes: [Attribute],
            Children: [Node],
          },
        ],
      },
    )?
      == "<html><head/><body/></html>",
  )
}

EncodeNestedChildren = \() none | error {
  Assert'True(
    Encode(
      Element{
        Tag: Node'Html{},
        Attributes: [Attribute],
        Children: [Node
          Element{
            Tag: Node'Body{},
            Attributes: [Attribute],
            Children: [Node
              Element{
                Tag: Node'Div{},
                Attributes: [Attribute],
                Children: [Node],
              },
            ],
          },
        ],
      },
    )?
      == "<html><body><div/></body></html>",
  )
}

EncodeTextNode = \() none | error {
  Assert'True(
    Encode(
      Element{
        Tag: Node'Html{},
        Attributes: [Attribute],
        Children: [Node "foo"],
      },
    )?
      == "<html>foo</html>",
  )
}
