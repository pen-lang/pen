import Test'Assert
import 'arguments

Parse= \() none | error {
  args = arguments'Parse([string "foo"])?

  Assert'EqualStrings(args.Directory, "foo")
}

FailToParseWithTooFewArguments = \() none | error {
  args = arguments'Parse([string])

  assertStringError(args, "too few arguments")
}

FailToParseWithTooManyArguments = \() none | error {
  args = arguments'Parse([string "foo", "bar"])

  assertStringError(args, "too many arguments")
}

assertStringError = \(x any, expected string) none | error {
  if e = x as error {
    if s = source(e) as string {
      Assert'EqualStrings(s, expected)
    } else {
      Assert'Fail()
    }
  } else {
    Assert'Fail()
  }
}
