import Test'Assert

import 'Stringify { Stringify }
import 'Value { Value }

StringifyNull = \() none | error {
  Assert'True(Stringify(Value'New(none)) == "null")
}

StringifyNumber = \() none | error {
  Assert'True(Stringify(Value'New(42)) == "42")
}

StringifyTrue = \() none | error {
  Assert'True(Stringify(Value'New(true)) == "true")
}

StringifyFalse = \() none | error {
  Assert'True(Stringify(Value'New(false)) == "false")
}

StringifyString = \() none | error {
  Assert'True(Stringify(Value'New("foo")) == "\"foo\"")
}

# TODO Escape special characters in strings.

StringifyArrayWithNoElement = \() none | error {
  Assert'True(Stringify(Value'New([Value])) == "[]")
}

StringifyArrayWithElement = \() none | error {
  Assert'True(Stringify(Value'New([Value Value'New(1)])) == "[1]")
}

StringifyArrayWith2Elements = \() none | error {
  Assert'True(
    Stringify(Value'New([Value Value'New(1), Value'New(2)]))
      == "[1,2]",
  )
}

StringifyArrayWith3Elements = \() none | error {
  Assert'True(
    Stringify(
      Value'New(
        [Value
          Value'New(1),
          Value'New(2),
          Value'New(3),
        ],
      ),
    )
      == "[1,2,3]",
  )
}

StringifyObjectWithNoEntry = \() none | error {
  Assert'True(Stringify(Value'New({string: Value})) == "{}")
}

StringifyObjectWithEntry = \() none | error {
  Assert'True(
    Stringify(
      Value'New(
        {string: Value
          "foo": Value'New(1),
        },
      ),
    )
      == "{\"foo\":1}",
  )
}

StringifyObjectWith2Entries = \() none | error {
  Assert'True(
    Stringify(
      Value'New(
        {string: Value
          "foo": Value'New(1),
          "bar": Value'New(2),
        },
      ),
    )
      == "{\"bar\":2,\"foo\":1}",
  )
}

StringifyObjectWith3Entries = \() none | error {
  Assert'True(
    Stringify(
      Value'New(
        {string: Value
          "foo": Value'New(1),
          "bar": Value'New(2),
          "baz": Value'New(3),
        },
      ),
    )
      == "{\"bar\":2,\"baz\":3,\"foo\":1}",
  )
}
